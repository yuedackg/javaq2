問題11　次のJavapプログラムの説明及びプログラムを読んで、設問に答えよ。
（Javaプログラムで使用するAPIの説明は、この冊子の末尾を参照してください。）
［プログラムの説明］
　ギャップバッファを利用した簡易テキストエディタである。
　ギャップバッファとは、編集対象となる文字列の編集個所に空き領域を作り、そこに文字を挿入する機構を持つバッファのことである。
一般に、テキスト編集時には、文字の挿入、削除などの変更は客所的に集中することが多く、編集個所にあらかじめ空き領域を作っておくと効率よく変更を行うことができるという利点がある。
ギャップバッファ内の空き領域をぎゃぷといい、ギャップバッファ内の文字列をテキストという。
ここで、ギャップは、ギャップバッファ内に一つしか存在しない。
ただし、文字の挿入によって、ギャップがないばあいがある。
テキストの表示イメージとギャップバッファを図1に示す（）網掛の部分がギャップである）。

クラスGapBufferはギャップバッファの機能を実現する。
このクラスの使用者は、テキストを仮想的に連続する文字列として扱うことあでき、ギャップの位置やサイズを意識せず未文字の挿入や削除の処理を行う。
この時、図１①のように各文字はオフセット値（offset）で指定し、テキストの最初の文字は、オフセット値０、テキストの最後の文字はオフセット値”テキストの文字数-1”で指定する。

図1②は、配列buffer内におけるテキストの物理的な表現の例である。
フィールドgapOffsetとgapSizeは、それぞれギャップの先頭位置とギャップのサイズを表す。

図１②の状態から、”プログラム”と”説明”の間に”の”を挿入する手順を図２に示す。

まず、”プロ”の直後に”グラム”を移動することで、ギャップを”プログラム”と”説明”のあだに移動する。
ギャップの先頭にのを格納する。
この操作によって、ギャップのサイズは1文字小さくなり、ギャップの先頭位置は1文字分後ろにずれる。

次に図2③の状態からプログラムのグを削除する手順を図３に示す。

まず、ラムのを説明の直前に移動することで、ギャップをプログとラムの説明の間に移動する（図３②）。
ぎゃおっぷの先頭文字を1文字分前にずらし、ギャップのサイズを1文字分増やす（図３③）。

クラスGapBufferは、次のコンストラクタ及びメソッドを持つ。

（１）コンストラクタは、引数initialTextで指定された文字列をテキストの初期値としてバッファを生成する。
ギャップは、テキストの前に作られる。

（２）メソッドinsertは、メソッドconfirmGapを読んで引数offsetの位置にギャップを移動した上で、引数offsetで指定された位置に、引数chで指定されて文字を入力する。
（３）メソッドdeleteは、引数offsetで指定された位置にある文字を削除する。テキストがない場合は、何もしない。
（４）メソッドcharAtは、引数offsetで指定された位置の文字を返す。
（５）メソッドlengthは、テキストの文字数を返す。
（６）メソッドconfirmGapは、配列bufferにおいて引数newGapOffsetで与えられた位置に1文字以上のギャップがあるようにする。

